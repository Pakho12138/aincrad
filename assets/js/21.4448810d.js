(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{543:function(t,e,s){"use strict";s.r(e);var a=s(1),n=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"使用-github-action-实现-github-自动同步代码到-gitee-并自动部署-gitee-pages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用-github-action-实现-github-自动同步代码到-gitee-并自动部署-gitee-pages"}},[t._v("#")]),t._v(" 使用 Github Action 实现 Github 自动同步代码到 Gitee，并自动部署 Gitee Pages")]),t._v(" "),e("h2",{attrs:{id:"_1-创建-workflow"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建-workflow"}},[t._v("#")]),t._v(" 1. 创建 workflow")]),t._v(" "),e("p",[t._v("在你的 GitHub 项目 "),e("code",[t._v(".github/workflows/")]),t._v(" 文件夹下创建一个 "),e("code",[t._v(".yml")]),t._v(" 文件，如 "),e("code",[t._v("sync.yml")]),t._v("，内容如下：")]),t._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Sync To Gitee "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#名字  可自定义")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" page_build "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#触发条件   page_build表示Github Page部署完成后触发")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# on:")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   push:")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     branches: [master, gh-pages]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sync")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Sync to Gitee\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" wearerequired/git"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mirror"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@master "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#开源actions包")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("SSH_PRIVATE_KEY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_PRIVATE_KEY "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("source-repo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'git@github.com:Pakho12138/Aincrad.git'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# github仓库地址")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("destination-repo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'git@gitee.com:pakhoc/Aincrad.git'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# gitee仓库地址")]),t._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Build Gitee Pages\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" yanglbme/gitee"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@main\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意替换为你的 Gitee 用户名")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gitee-username")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 326061636@qq.com\n          "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意在 Settings->Secrets 配置 GITEE_PASSWORD")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gitee-password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_PASSWORD "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意替换为你的 Gitee 仓库，仓库名严格区分大小写，请准确填写，否则会出错")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gitee-repo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pakhoc/Aincrad\n          "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 要部署的分支，默认是 master，若是其他分支，则需要指定（指定的分支必须存在）")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gh"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br")])]),e("p",[t._v("注：")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("这里先使用 "),e("a",{attrs:{href:"https://github.com/wearerequired/git-mirror-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("wearerequired/git-mirror-action"),e("OutboundLink")],1),t._v(" 将 GitHub 仓库同步到 Gitee 仓库，再使用 "),e("a",{attrs:{href:"https://github.com/yanglbme/gitee-pages-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("yanglbme/gitee-pages-action"),e("OutboundLink")],1),t._v(" 实现 Gitee Pages 的自动部署。如果已经通过其它的方式，将代码 push 至 Gitee 了，那么可以不使用 "),e("a",{attrs:{href:"https://github.com/wearerequired/git-mirror-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("wearerequired/git-mirror-action"),e("OutboundLink")],1),t._v("，也不需要配置 "),e("code",[t._v("GITEE_PRIVATE_KEY")]),t._v("。")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("branch")]),t._v(" 参数默认是 "),e("code",[t._v("master")]),t._v("，如果你是部署在 "),e("code",[t._v("gh-pages")]),t._v("(或者 "),e("code",[t._v("main")]),t._v(") 分支等等，务必指定 "),e("code",[t._v("branch: gh-pages")]),t._v("(或者 "),e("code",[t._v("branch: main")]),t._v(")。")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("branch")]),t._v(" 对应的分支，必须在仓库中实际存在，请不要随意（不）指定分支，否则可能导致 Gitee Pages 站点出现 404 无法访问的情况。")])]),t._v(" "),e("li",[e("p",[t._v("对于 "),e("code",[t._v("gitee-repo")]),t._v(" 参数，如果你的项目在 Gitee 的地址为 https://gitee.com/用户名/xxx ，那么 "),e("code",[t._v("gitee-repo")]),t._v(" 就填写为 "),e("code",[t._v("用户名/xxx")]),t._v("。")])]),t._v(" "),e("li",[e("p",[t._v("对于 workflow 的触发事件，你可以根据项目实际情况，指定为其它的触发事件。比如：")]),t._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("master"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" gh"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])])])]),t._v(" "),e("p",[t._v("更多触发事件，请参考 "),e("a",{attrs:{href:"https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows",target:"_blank",rel:"noopener noreferrer"}},[t._v("Events that trigger workflows"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"_2-配置密钥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置密钥"}},[t._v("#")]),t._v(" 2. 配置密钥")]),t._v(" "),e("p",[t._v("密钥的配置步骤如下：")]),t._v(" "),e("p",[t._v("a. 在命令行终端或 Git Bash 使用命令 "),e("code",[t._v('ssh-keygen -t rsa -C "youremail@example.com"')]),t._v(" 生成 SSH Key，注意替换为自己的邮箱。生成的 "),e("code",[t._v("id_rsa")]),t._v(" 是私钥，"),e("code",[t._v("id_rsa.pub")]),t._v(" 是公钥。(⚠️ 注意此处不要设置密码，生成的公私钥用于下面 GitHub / Gitee 的配置，以保证公私钥成对，否则从 GitHub -> Gitee 的同步将会失败。)")]),t._v(" "),e("p",[t._v("b. 在 GitHub 项目的「Settings -> Secrets and variables -> Actions」"),e("strong",[t._v("Repository secrets")]),t._v("下配置好命名为 "),e("code",[t._v("GITEE_PRIVATE_KEY")]),t._v(" 和 "),e("code",[t._v("GITEE_PASSWORD")]),t._v(" 的两个密钥。其中："),e("code",[t._v("GITEE_PRIVATE_KEY")]),t._v(" 存放 "),e("code",[t._v("id_rsa")]),t._v(" 私钥；"),e("code",[t._v("GITEE_PASSWORD")]),t._v(" 存放 Gitee 帐号的密码。")]),t._v(" "),e("p",[t._v("c. 在 GitHub 的个人设置页面「"),e("a",{attrs:{href:"https://github.com/settings/keys",target:"_blank",rel:"noopener noreferrer"}},[t._v("Settings -> SSH and GPG keys"),e("OutboundLink")],1),t._v("」配置 SSH 公钥（即："),e("code",[t._v("id_rsa.pub")]),t._v("），命名随意。")]),t._v(" "),e("p",[t._v("d. 在 Gitee 的个人设置页面「"),e("a",{attrs:{href:"https://gitee.com/profile/sshkeys",target:"_blank",rel:"noopener noreferrer"}},[t._v("安全设置 -> SSH 公钥"),e("OutboundLink")],1),t._v("」配置 SSH 公钥（即："),e("code",[t._v("id_rsa.pub")]),t._v("），命名随意。")]),t._v(" "),e("h2",{attrs:{id:"_3-关注-gitee-公众号"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-关注-gitee-公众号"}},[t._v("#")]),t._v(" 3. 关注 Gitee 公众号")]),t._v(" "),e("p",[t._v("关注 Gitee 官方公众号，并绑定个人 Gitee 帐号，用于接收帐号登录通知、以及绕过短信验证码校验，见"),e("a",{attrs:{href:"https://github.com/marketplace/actions/gitee-pages-action#%E9%94%99%E8%AF%AF%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88",target:"_blank",rel:"noopener noreferrer"}},[t._v("错误及解决方案"),e("OutboundLink")],1),t._v(" 第 3 点。")]),t._v(" "),e("h2",{attrs:{id:"_4-运行结果"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-运行结果"}},[t._v("#")]),t._v(" 4. 运行结果")]),t._v(" "),e("p",[t._v("如果一切配置正常，并成功触发 "),e("a",{attrs:{href:"https://github.com/marketplace/actions/gitee-pages-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gitee Pages Action"),e("OutboundLink")],1),t._v(" ，Gitee Pages Action 会打印出成功的结果。并且，我们会在 Gitee 公众号收到一条登录通知。这是 Gitee Pages Action 程序帮我们登录到 Gitee 官网，并为我们点击了项目的部署按钮。")]),t._v(" "),e("br"),t._v(" "),e("p",[e("strong",[t._v("参考文章： "),e("a",{attrs:{href:"https://github.com/marketplace/actions/gitee-pages-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gitee Pages Action"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=n.exports}}]);